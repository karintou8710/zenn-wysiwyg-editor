.tiptap {
  margin: 5rem 0 10rem;
  padding: 40px 2rem;
  border-radius: 10px;
  outline: none;
  background: white;
  min-height: 600px;

  img.ProseMirror-separator {
    display: inline !important;
    border: none !important;
    margin: 0 !important;
  }

  h1,
  h2,
  h3,
  h4 {
    font-weight: 700;
  }

  div.code-block-filename-container {
    span {
      min-width: 85px;
    }
  }

  .code-block-wrapper-for-langname {
    position: relative;

    &:after {
      position: absolute;
      top: 0;
      right: 0;
      content: attr(data-language);
      display: block;
      font-size: 0.7rem;
      padding: 0.1rem 0.3rem;
      background-color: oklch(96.7% 0.003 264.542);
    }
  }

  div.code-block-filename-container {
    .code-block-filename {
      /* PC版Safariで display: table をspanにつけると、contenteditableでの編集がバグる */
      display: inline-block;
    }
  }

  .diff-code-line {
    display: block;
  }

  /* 
    detailsタグとcontenteditableの併用が厳しいため、divにクラスをつける。 
    zenn-content-css からスタイルはコピーする
  */
  .details {
    font-size: 0.95em;
    margin: 1rem 0;
    line-height: 1.7;

    summary {
      cursor: default;
      display: flex;
      align-items: center;

      button {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transform: rotate(90deg);

        &:hover {
          background: oklch(96.7% 0.003 264.542);
        }

        .triangle {
          background: black;
          height: calc(tan(60deg) * 10px / 2);
          width: 10px;
          clip-path: polygon(50% 0, 100% 100%, 0 100%);
        }
      }

      div {
        margin-left: 0.5rem;
        flex: 1;
      }
    }

    &[data-open] {
      /*  ネストされる場合があるため、直下のみ反映 */
      & > summary {
        border-radius: 14px 14px 0 0;
        box-shadow: none;
        background: #edf2f7; /* var(--c-bg-dim); */
        border-bottom: none;

        button {
          transform: rotate(180deg);

          &:hover {
            background: oklch(92.8% 0.006 264.531);
          }
        }
      }
    }

    .details-content {
      padding: 0.5em 0.9em;
      border: 1px solid #d6e3ed; /* var(--c-border) */
      border-radius: 0 0 14px 14px;
      background: #fff /* var(--c-bg-base) */;
    }

    /*  ネストされる場合があるため、直下のみ反映 */
    &:not([data-open]) > .details-content {
      display: none;
    }
  }
}

/* Selection */
.tiptap {
  &::selection {
    background-color: rgba(35, 131, 226, 0.3);
  }

  hr {
    &.ProseMirror-selectednode {
      outline: 2px solid #9333ea;
      outline-offset: 2px;
    }
  }

  p,
  h1,
  h2,
  h3,
  h4,
  ul,
  ol,
  blockquote,
  aside,
  div.code-block-container,
  span.embed-block,
  div.details {
    &.ProseMirror-selectednode {
      position: relative;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;

      &::selection {
        background: transparent !important;
      }

      &::after {
        position: absolute;
        content: "";
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(35, 131, 226, 0.3);
        border-radius: 4px;
        pointer-events: none;
      }
    }
  }
}

/* Placeholder */
.tiptap {
  p.is-editor-empty:first-child::before {
    color: #adb5bd;
    content: attr(data-placeholder);
    float: left;
    height: 0;
    pointer-events: none;
  }

  p.is-empty::before {
    color: #adb5bd;
    content: attr(data-placeholder);
    float: left;
    height: 0;
    pointer-events: none;
  }

  h1.is-empty::before,
  h2.is-empty::before,
  h3.is-empty::before {
    color: #6b7280;
    content: attr(data-placeholder);
    float: left;
    height: 0;
    pointer-events: none;
  }

  p > img + em.is-empty::before {
    color: #adb5bd;
    content: attr(data-placeholder);
  }

  div.code-block-filename-container.is-empty {
    .code-block-filename::before {
      color: #adb5bd;
      content: "ファイル名"; /* 親要素にdata-placeholderが設定されてしまうため、ハードコーディング */
      float: left;
      height: 0;
      pointer-events: none;
    }
  }
}
